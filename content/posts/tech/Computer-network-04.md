---
title: "【计算机网络】第四章 网络层"
date: 2023-11-27T00:17:58+08:00
lastmod: 2023-11-27T00:17:58+08:00
author: ["Eddy"]
keywords: 
- computer network
categories: 
- 
tags: 
- 计算机网络
description: ""
weight:
slug: ""
draft: false # 是否为草稿
comments: false
reward: false # 打赏
mermaid: true #是否开启mermaid
showToc: true # 显示目录
TocOpen: true # 自动展开目录
hidemeta: false # 是否隐藏文章的元信息，如发布日期、作者等
disableShare: true # 底部不显示分享栏
showbreadcrumbs: true #顶部显示路径
cover:
    image: "https://testingcf.jsdelivr.net/gh/EddyCliff/ChartBed/BlogCover/note6.jpg" #图片路径例如：posts/tech/123/123.png
    caption: "" #图片底部描述
    alt: ""
    relative: false
---
## 第四章 网络层

### 本章的重要概念

1）TCP/IP体系中的网络层向上只提供简单灵活的、无连接的、尽最大努力交付的数据报服务。网络层不提供服务质量的承诺，不保证分组交付的时限，所传送的分组可能出错、丢失、重复和失序。进程之间通信的可靠性由运输层负责。

2）IP网是虚拟的，因为从网络层上看，IP网好像是一个统一的、抽象的网络（实际上是异构的)。IP层抽象的互联网屏蔽了下层网络很复杂的细节，使我们能够使用统一的、抽象的IP地址处理主机之间的通信问题。

3）在互联网上的交付有两种：在本网络上的直接交付（不经过路由器）和到其他网络的间接交付（经过至少一个路由器，但最后一次一定是直接交付）。

4）IP地址是一种分等级的地址结构。一个IP地址在整个互联网范围内是唯一的。

5）最初使用的IP地址是分类的IP地址，包括A类、B类和C类地址(单播地址).以及D类地址（多播地址）。E类地址未使用。IP地址最前面的类别位指明IP地址的类别。

6）CIDR 记法把 IP地址后面加上斜线“/”，斜线后面是前缀所占的位数。前缀（或网络前缀）用来指明网络（相当于分类地址中的网络地址），后缀用来指明主机（相当于分类地址中的主机号）。CIDR把前缀都相同的连续的IP地址组成一个“CIDR地址块”。IP 地址的分配都以CIDR地址块为单位。

7）CIDR的32位地址掩码（或子网掩码）由一串1和一串0组成，而1的个数就是前缀的长度。只要把IP地址和地址掩码逐位进行“逻辑与（AND）”运算，即可得出网络地址。A类地址的默认地址掩码是255000。B类地址的默认地址掩码是255.255.0.0。C类地址的默认地址掩码是255.255.255.0。

8）地址聚合（把许多前缀相同的地址用一个前缀来代替）有利于减少转发表中的项目，减少路由器之间的路由选择信息的交换，从而提高了整个互联网的性能。

9）IP地址管理机构在分配IP地址时只分配网络号，而主机号则由得到该网络号的单位自行分配。路由器仅根据目的主机所连接的网络号来转发分组。

10）IP地址标志一台主机（或路由器）和一条链路的接口。多归属主机同时连接到两个或更多的网络上。这样的主机同时具有两个或更多的IP地址，其网络号必须是不同的。由于一个路由器至少应当连接到两个网络，因此一个路由器至少应当有两个不同的IP地址。
11）按照互联网的观点，用转发器或以太网交换机连接起来的若干个局域网仍为一个网络。所有分配到网络号的网络（不管是范围很小的局域网，还是可能覆盖很大地理范围的广域网)都是平等的。

12）物理地址（即MAC地址)是数据链路层和物理层使用的地址，而IP地址是网络层和以上各层使用的地址，是一种逻辑地址（用软件实现的），在数据链路层看不见数据报的IP地址。

13）IP 数据报分为首部和数据两部分。首部的前一部分为固定长度，共20字节，是所有IP数据报必须具有的（源地址、目的地址、总长度等重要字段都在固定首部中）。一些长度可变的可选字段放在固定首部的后面。

14）IP首部中的生存时间字段给出了IP数据报在互联网中所能经过的最大路由器数，可防止IP数据报在互联网中无限制地兜圈子。

15）地址解析协议 ARP把IP地址解析为MAC地址，它解决同一个局域网上的主机或路由器的IP地址和MAC地址的映射问题。ARP的高速缓存可以大大减少网络上的通信量。在互联网中，我们无法仅根据MAC地址寻找到在某个网络上的某台主机。因此，从IP地址到MAC地址的解析是非常必要的。

16）“转发”和“路由选择”有区别。“转发”是单个路由器的动作。“路由选择”是许多路由器共同协作的过程，这些路由器相互交换信息，目的是生成路由表，再从路由表导出转发表。若采用自适应路由选择算法，则当网络拓扑变化时，路由表和转发表都能够自动更新。

17）自治系统（AS）就是在单一的技术管理下的一组路由器。一个自治系统对其他自治系统表现出的是一个单一的和一致的路由选择策略。

18）路由选择协议有两大类：自治系统内部的路由选择协议，如RIP和OSPF；自治系统之间的路由选择协议，如BGP-4。

19）RIP是分布式的基于距离向量的路由选择协议，只适用于小型互联网。RIP按固定的时间间隔与相邻路由器交换信息。交换的信息是自己当前的路由表，即到达本自治系统中所有网络的（最短）距离，以及到每个网络应经过的下一跳路由器。

20）OSPF是分布式的链路状态协议，适用于大型互联网。OSPF只在链路状态发生变化时，才向本自治系统中的所有路由器，用洪泛法发送与本路由器相邻的所有路由器的链路状态信息。“链路状态”指明本路由器都和哪些路由器相邻，以及该链路的“度量”。“度量”可表示费用、距离、时延、带宽等，可统称为“代价”。所有的路由器最终都能建立一个全网的拓扑结构图。

21）BGP-4 是不同自治系统AS 的路由器之间交换路由信息的协议，是一种路径向量路由选择协议。BGP力求寻找一条能够到达目的网络（可达）且比较好的路由（不兜圈子），而并非要寻找一条最佳路由。

22）网际控制报文协议ICMP是IP层的协议。ICMP报文作为IP数据报的数据，加上首部后组成IP数据报发送出去。使用ICMP并非为了实现可靠传输。ICMP允许主机或路由器报告差错情况和提供有关异常情况的报告。ICMP报文的种类有两种，即ICMP差错报告报文和ICMP询问报文。

23）ICMP的一个重要应用就是分组网间探测 PING，用来测试两台主机之间的连通性。PING使用了ICMP回送请求与回送回答报文。
要解决IP地址耗尽的问题，最根本的办法就是采用具有更大地址空间的新版本的IP协议，即IPv6。

24）IPv6 所带来的主要变化是：（1）更大的地址空间（采用128位的地址）；（2）灵活的首部格式；（3） 改进的选项；(4) 支持即插即用；（5) 支持资源的预分配；(6) IPv6 首部改为8字节对齐。

25）IPv6数据报在基本首部的后面允许有零个或多个扩展首部，再后面是数据。所有的扩展首部和数据合起来叫作数据报的有效载荷或净负荷。

26）IPv6数据报的目的地址可以是以下三种基本类型地址之一：单播、多播和任播。

27）IPv6的地址使用冒号十六进制记法。

28）向IPv6 过渡只能采用逐步演进的办法，必须使新安装的IPv6 系统能够向后兼容。向IPv6过渡可以使用双协议栈或使用隧道技术。

29）虚拟专用网VPN利用公用的互联网作为本机构各专用网之间的通信载体。VPN内部使用互联网的专用地址。一个VPN至少要有一个路由器具有合法的全球IP地址，这样才能和本系统的另一个VPN通过互联网进行通信。所有通过互联网传送的数据都必须加密。

30）使用网络地址转换NAT 技术，可以在专用网络内部使用专用IP地址，而仅在连接到互联网的路由器中使用全球IP地址。这样就大大节约了宝贵的IP地址。



彩蛋🎁 

草木蔓发，春山可望。

- 唐- 王维 《山中与裴秀才迪书》

恭喜你🎉，完成了对第四章《网络层》部分的学习，下一章我们将学习网络层。

⏩第五章 《运输层》

## 资料来源

[1]计算机网络简明教程（第四版），谢希仁.

